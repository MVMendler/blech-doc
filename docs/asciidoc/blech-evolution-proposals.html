<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.10">
<title>Blech evolution proposals</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment @import statement to use as custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*::before,*::after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite::before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed;word-wrap:break-word}
:not(pre)>code.nobreak{word-wrap:normal}
:not(pre)>code.nowrap{white-space:nowrap}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details>summary:first-of-type{cursor:pointer;display:list-item;outline:none;margin-bottom:.75em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class="highlight"],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos{border-right:1px solid currentColor;opacity:.35;padding-right:.5em}
pre.pygments .lineno{border-right:1px solid currentColor;opacity:.35;display:inline-block;margin-right:.75em}
pre.pygments .lineno::before{content:"";margin-right:-.125em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;text-align:left;margin-right:0}
table.tableblock{max-width:100%;border-collapse:separate}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
td.tableblock>.content>:last-child.sidebarblock{margin-bottom:0}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>thead>tr>.tableblock,table.grid-all>tbody>tr>.tableblock{border-width:0 1px 1px 0}
table.grid-all>tfoot>tr>.tableblock{border-width:1px 1px 0 0}
table.grid-cols>*>tr>.tableblock{border-width:0 1px 0 0}
table.grid-rows>thead>tr>.tableblock,table.grid-rows>tbody>tr>.tableblock{border-width:0 0 1px}
table.grid-rows>tfoot>tr>.tableblock{border-width:1px 0 0}
table.grid-all>*>tr>.tableblock:last-child,table.grid-cols>*>tr>.tableblock:last-child{border-right-width:0}
table.grid-all>tbody>tr:last-child>.tableblock,table.grid-all>thead:last-child>tr>.tableblock,table.grid-rows>tbody>tr:last-child>.tableblock,table.grid-rows>thead:last-child>tr>.tableblock{border-bottom-width:0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot,table.frame-ends{border-width:1px 0}
table.stripes-all tr,table.stripes-odd tr:nth-of-type(odd),table.stripes-even tr:nth-of-type(even),table.stripes-hover tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{margin-right:.25em}
ul.inline{display:-ms-flexbox;display:-webkit-box;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media print,amzn-kf8{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
</head>
<body class="article toc2 toc-left">
<div id="header">
<h1>Blech evolution proposals</h1>
<div class="details">
<span id="revdate">December, 2019</span>
<br><span id="revremark">(Pre-Release)</span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_accessing_the_blech_environment">1. Accessing the Blech environment</a>
<ul class="sectlevel2">
<li><a href="#_environment_variables">Environment variables</a></li>
<li><a href="#_external_read_write_c_variables_are_singletons">External read-write C variables are singletons</a></li>
<li><a href="#_singletons_and_separate_compilation">Singletons and separate compilation</a></li>
<li><a href="#_the_diamond_call_problem">The diamond call problem</a></li>
<li><a href="#_structured_access_to_external_variables">Structured access to external variables</a></li>
</ul>
</li>
<li><a href="#_calling_into_the_blech_environment">2. Calling into the Blech environment</a>
<ul class="sectlevel2">
<li><a href="#_external_c_functions">External C functions</a></li>
<li><a href="#_external_functions_with_side_effects_are_singletons">External functions with side-effects are singletons</a></li>
<li><a href="#_callers_become_singletons_too">Callers become singletons too</a></li>
<li><a href="#_correct_protocols_become_singletons_too">Correct protocols become singletons too</a></li>
</ul>
</li>
<li><a href="#_bits_and_bytes">3. Bits and Bytes</a>
<ul class="sectlevel2">
<li><a href="#_rename_the_exponentiation_operator">Rename the exponentiation operator <code>^</code></a></li>
<li><a href="#_rename_uint_to_nat">Rename <code>uint</code> to <code>nat</code></a></li>
<li><a href="#_allow_a_type_annotation_for_expressions">Allow a type annotation <code>:</code> for expressions</a></li>
<li><a href="#_eliminate_floatliteral32">Eliminate <code>floatLiteral32</code></a></li>
<li><a href="#_bit_types">Bit types</a></li>
<li><a href="#_bitwise_operators">Bitwise operators</a></li>
<li><a href="#_no_subtyping_for_bitsn_types">No subtyping for <code>bitsN</code> types</a></li>
<li><a href="#_literals">Literals</a></li>
<li><a href="#_use_of_operations">Use of operations</a></li>
<li><a href="#_hackers_delight_translated_to_blech">Hacker&#8217;s Delight translated to Blech</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="_accessing_the_blech_environment"><a class="anchor" href="#_accessing_the_blech_environment"></a>1. Accessing the Blech environment</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_environment_variables"><a class="anchor" href="#_environment_variables"></a>Environment variables</h3>
<div class="paragraph">
<p>Environment variables are either read-only inputs or read-write outputs.
Every environment variables has a counterpart in the Blech environment.
Therefore, they are annotated as <code>@[CInput &#8230;&#8203;]</code> or <code>@[COutput &#8230;&#8203;]</code>.
Environment variables are classified by the keyword <code>extern</code>.
A <code>extern let</code> definition must be annotated with a <code>@[CInput &#8230;&#8203;]</code>.
An <code>extern var</code> definition must be annotated with a <code>@[COutput &#8230;&#8203;]</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="blech">@[CInput (binding = "theSensor", header = "sensors.h")]
extern let sensor: uint8

@[COutput (binding = "spiIsReady", header = "spi.h")]
extern var spiReady: bool</code></pre>
</div>
</div>
<div class="paragraph">
<p>Since the external C variables bound to the environment variables live in the environment they do not follow the synchronous semantics.
They might be <code>volatile</code> changing their value during a reaction.
They might be read or written asynchronously by the environment.</p>
</div>
<div class="paragraph">
<p>In order to synchronize these C variables, the Blech program holds a buffered value of the external value in the environment variable.</p>
</div>
<div class="paragraph">
<p>The Blech runtime system takes care of the synchronisation.
Before the reaction, the values of all external C variables are copied into the environment variable.
After the reaction, the values of the <code>extern var</code> variables are copied into the external C variables.</p>
</div>
<div class="paragraph">
<p>The implementation is allowed to distribute these copying operations into the code generated for each activity, that defines <code>extern</code> variables.</p>
</div>
<div class="paragraph">
<p>Environment variables can only be declared in an <code>activity</code>.
Functions can only access environment variables via the parameter list.</p>
</div>
</div>
<div class="sect2">
<h3 id="_external_read_write_c_variables_are_singletons"><a class="anchor" href="#_external_read_write_c_variables_are_singletons"></a>External read-write C variables are singletons</h3>
<div class="paragraph">
<p>An external C variable is a global variable, which is in danger to be accessed concurrently via the environment variable.
While Blech in general prevents this danger by not allowing the declaration of global variables at all, it needs more effort to guarantee this for external C variables.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="blech">activity handleCVariables()

    @[CInput (binding = "theSensor", header = "sensors.h")]
    extern let sensor: uint8
    @[COutput (binding = "spiIsReady", header = "spi.h")]
    extern var spiReady: bool

    repeat
        if sensor &gt; 10 then
            spiReady = true
        end
        await true
    end
end</code></pre>
</div>
</div>
<div class="paragraph">
<p>In order to comply to the single-writer principle, declaring an <code>extern var</code> variable in an activity restricts this activity to be instantiated only once.
The declared variable is a <code>singleton</code> and does not allow multiple instances.
An activity that declares a singleton cannot be called concurrently, but only sequentially.
Note that this is only necessary for <code>extern var</code> declarations.
An <code>extern let</code> variable is <strong>not</strong> a <code>singleton</code>.
Different instances of such an activity can have separate buffers of the external C variable, which might have different values in the same reaction if the external C variable is <code>volatile</code>.
It is the responsibility of the programmer not to share external C variables in different <code>extern var</code> declarations.
Two or more <code>extern let</code> declarations are allowed to have the same annotation <code>@[CInput &#8230;&#8203;]</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_singletons_and_separate_compilation"><a class="anchor" href="#_singletons_and_separate_compilation"></a>Singletons and separate compilation</h3>
<div class="paragraph">
<p>If a module exports an activity that contains a singleton, the signature needs to reflect this in order to enable a correct causality analysis.
The signature for the above activity <code>handleCVariables</code> looks like the following</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="blech">singleton handleCVariables.spiReady
activity handleCVariables()</code></pre>
</div>
</div>
<div class="paragraph">
<p>It shows the activities prototype, exposes the unique names of the singletons and shows their annotations.
Showing the annotations allows to check the binding to C variables also for modules where the implementation is hidden.</p>
</div>
</div>
<div class="sect2">
<h3 id="_the_diamond_call_problem"><a class="anchor" href="#_the_diamond_call_problem"></a>The diamond call problem</h3>
<div class="paragraph">
<p>If an activity declares a singleton, it still can be called from several activities.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="blech">activity firstUsage()
    run handleCVariables()
end

activity secondUsage()
    run handleCVariables()
end</code></pre>
</div>
</div>
<div class="paragraph">
<p>Again <code>firstUsage</code> and <code>secondUsage</code> can not be called concurrently.</p>
</div>
<div class="paragraph">
<p>In order to check this via the signature, the calling activities, inherits the singletons from the called activity.
In a module signature these activities occur as follows</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="blech">singleton handleCVariables.spiReady
activity firstUsage()

singleton handleCVariables.spiReady
activity secondUsage()</code></pre>
</div>
</div>
<div class="paragraph">
<p>If we combine activities with different singletons, they must not be called concurrently, if they share common singletons.
For example assume the following module signature.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="blech">signature Module

singleton handleOtherCVariable.theExternVar
activity handleOtherCVariable()</code></pre>
</div>
</div>
<div class="paragraph">
<p>A calling activity might inherit all singletons</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="blech">import Module

activity thirdUsage()
    cobegin
        run handleCVariables()
    with
        run handleOtherCVariable()
    end
end</code></pre>
</div>
</div>
<div class="paragraph">
<p>The deduced signature is</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="blech">import Module

singleton handleCVariables.spiReady,
          Module.handleOtherCVariable.theExternVar
activity thirdUsage()</code></pre>
</div>
</div>
<div class="paragraph">
<p>Activity <code>thirdUsage</code> cannot be called concurrently to <code>firstUsage</code> or <code>secondUsage</code> because their singletons overlap.</p>
</div>
</div>
<div class="sect2">
<h3 id="_structured_access_to_external_variables"><a class="anchor" href="#_structured_access_to_external_variables"></a>Structured access to external variables</h3>
<div class="paragraph">
<p>Environment variables can also be referenced from a <code>struct</code> type, like normal Blech variables.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="blech">struct MyCVariables
    var x: int32
    let ref sensor: uint8
    var ref spiReady: bool
end</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="blech">activity referToCVariables()
    @[CInput (binding = "theSensor", header = "sensors.h")]
    extern let sensor: uint8

    @[COutput (binding = "spiIsReady", header = "spi.h")]
    extern var spiReady: bool

    var mcvs: MyCVariables = { x = 0, sensor = sensor, spiReady = spiReady }
end</code></pre>
</div>
</div>
<div class="paragraph">
<p>If we use both activities <code>referToCVariables</code> and <code>handleCVariables</code> in a Blech program we obviously made a mistake.
Both activities write to the same external C Variable <code>"spiIsReady"</code>.
The single-writer principle is broken.
The semantics of the program is undefined concerning the environment access.
In general working with externals is unsafe.
In this particular case, it is the responsibility of the programmer to take care, not to share the same <code>COutput</code> between different <code>extern var</code> declarations.</p>
</div>
<div class="paragraph">
<p>The signatures of both activities cannot reveal this error.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="blech">singleton referToCVariables.spiReady
activity referToCVariables()

singleton handleCVariables.spiReady
activity handleCVariables()</code></pre>
</div>
</div>
<div class="paragraph">
<p>Idea: It should be the responsibility. of the compiler to collect the environment of a Blech program across all modules in order to allow for a code review supported by such a description file.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<code>extern var</code> and <code>extern let</code> declarations cannot be declared inside functions.
Use <code>extern let</code> declarations when possible in order to prevent the propagation of the singletons.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Since signatures are deduced by the compiler, the whole checking of singletons and the generation of appropriate signatures is done by the compiler.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
A conventional embedded program is full of singletons, not only created by <code>extern var</code> declarations, but especially by global variables.
In order to maintain the single-writer principle by programming discipline it is almost inevitable, that all functions are only called once in a task list.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This makes reuse and testing extremely difficult. Only the rather small number of services is reusable and rather easily testable.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_calling_into_the_blech_environment"><a class="anchor" href="#_calling_into_the_blech_environment"></a>2. Calling into the Blech environment</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_external_c_functions"><a class="anchor" href="#_external_c_functions"></a>External C functions</h3>
<div class="paragraph">
<p>External C functions are either pure functions or functions with side-effects.
Pure functions do not change the environment.
Functions with side-effects change the environment via global variables, not visible in the function prototype.</p>
</div>
<div class="paragraph">
<p>External C functions are classified by the keyword <code>extern</code>.
If the function already exists, an annotation defining the binding to this C function can be added: <code>@[CFunction &#8230;&#8203;]</code>.</p>
</div>
<div class="paragraph">
<p>If the external C function is a pure function with no hidden side effects it follows the synchronous semantics and allows for correct causality analysis.</p>
</div>
<div class="paragraph">
<p>If the external C function is a function with side-effects on global variables in the environment, it does not follow the synchronous semantics.
From the prototype of this function the read-write access to these global variables is not visible.
As a consequence, causality analysis cannot prevent calling this function from concurrent trails.
This means, the single-writer principle on global variables in the environment cannot be maintained.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="blech">@[CFunction(binding="")]
extern function noSideEffect()

@[CFunction(binding="")]
extern function hasSideEffect() // writes to a global variable

activity multipleWriters()
    cobegin
        noSideEffect()
        await true
        hasSideEffect()
    with
        await true
        hasSideEffect()
    end
end</code></pre>
</div>
</div>
<div class="paragraph">
<p>Here the function <code>hasSideEffect</code> is called from two concurrent trails.
The effect on the global variable is not predictable and depends on the order in which both calls are scheduled by the code generation.</p>
</div>
</div>
<div class="sect2">
<h3 id="_external_functions_with_side_effects_are_singletons"><a class="anchor" href="#_external_functions_with_side_effects_are_singletons"></a>External functions with side-effects are singletons</h3>
<div class="paragraph">
<p>In order two prevent concurrent writes on global variables in the environment it needs more effort by the programmer.
An external C function with side effects should be declared as a <code>singleton</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="blech">@[CFunction(binding="")]
extern function noSideEffect()

@[CFunction(binding="")]
extern singleton function hasSideEffect() // writes to a global variable

activity multipleWriters()
    cobegin
        noSideEffect()
        await true
        hasSideEffect()
    with
        await true
        hasSideEffect() // causality error
    end
end</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>hasSideEffects</code> being a <code>singleton</code> makes the above program causally incorrect.
A correct program restricts calling <code>hasSideEffects</code> to one trail.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="blech">activity singleWriter()
    cobegin
        noSideEffect()
        await true
        hasSideEffect()
    with
        await true
        noSideEffect()
    end
end</code></pre>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
It is the responsibility of the programmer to declare external C functions that write to global variables as <code>singleton</code>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_callers_become_singletons_too"><a class="anchor" href="#_callers_become_singletons_too"></a>Callers become singletons too</h3>
<div class="paragraph">
<p>The signature for this 3 subprograms looks like the following</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="blech">function noSideEffect()
singleton function hasSideEffect() // reads and write a global variable

singleton hasSideEffect
activity singleWriter()</code></pre>
</div>
</div>
<div class="paragraph">
<p>Since <code>activity</code> singleWriter calls a singleton it becomes a <code>singleton</code> too.
The singleton property is deduced by the compiler, there is no need to declare <code>singleWriter</code> as a singleton.</p>
</div>
<div class="paragraph">
<p>The same is true for function that calls a singleton function.</p>
</div>
</div>
<div class="sect2">
<h3 id="_correct_protocols_become_singletons_too"><a class="anchor" href="#_correct_protocols_become_singletons_too"></a>Correct protocols become singletons too</h3>
<div class="paragraph">
<p>Although the singleton property only maintains the single-writer principle it is also usefull for more complex protocols.</p>
</div>
<div class="paragraph">
<p>Assume the following interface functions for accessing an SPI interface</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="blech">@[CFunction(binding = "NRF24L01_spiXferBytes", header = "nrf24l01.h")]
extern singleton function SPI_XferBytes (txBuf: [SPI_TX_BUF]uint8, len: uint16)
                                        (rxBuf: [SPI_TX_BUF]uint8)
                                        returns int8

@[CFunction(binding = "NRF24L01_spiIsReady", header = "nrf24l01.h")]
extern singleton function SPI_isReady () returns bool

@[CFunction(binding = "NRF24L01_beginTransfer", header = "nrf24l01.h")]
extern singleton function SPI_beginTransfer ()

@[CFunction(binding = "NRF24L01_endTransfer", header = "nrf24l01.h")]
extern singleton function SPI_endTransfer ()</code></pre>
</div>
</div>
<div class="paragraph">
<p>Functions which change the environment are declared as <code>singleton</code> in order to make sure that they are not called from concurrent trails.</p>
</div>
<div class="paragraph">
<p>Function <code>SPI_isReady</code> is read-only but should also be declared as a <code>singleton</code>.
The reason is that two calls to <code>SPI_isReady</code> could have different results because the underlying flag in the environment is changed asynchronously.</p>
</div>
<div class="paragraph">
<p>Without declaring <code>SPI_isReady</code> as a singleton the following code can have unpredictable results</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="blech">cobegin
    await SPI_isReady()
    ...
with
    await SPI_isReady()
    ...
end</code></pre>
</div>
</div>
<div class="paragraph">
<p>Within the same reaction, one trail might wait, while the other might go on.
Being a <code>singleton</code> concurrent calls would not be allowed, an the above code would be rejected by the compiler.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
External functions that might return a different result in every call should be declared as <code>singleton</code>.
Typically this is necessary when the result depends on <code>volatile</code> or asynchronously changed data.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The <code>activity</code> transfering bytes via SPI, can be written as follows.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="blech">activity SPI_txRxBytes (bufTx: [SPI_TX_BUF]uint8, len: uint16)
                       (bufRx: [SPI_TX_BUF]uint8)
                       returns int8
    // SPI ready for TX?
    if not SPI_isReady() then
        await SPI_isReady()
    end

    // Trigger asynchronous byte transfer via SPI.
    if SPI_XferBytes (bufTx, bufRx, len) != 0 then
        return -1
    end

    // Await completion.
    await SPI_isReady()
    return 0
end</code></pre>
</div>
</div>
<div class="paragraph">
<p>This activity is a singleton because it calls singleton functions.</p>
</div>
<div class="paragraph">
<p>Of coures it is possible to call, for example, two singleton functions concurrently.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="blech">    cobegin
        SPI_beginTransfer()
        await true
    with
        SPIEndTransfer()
        await true
    end</code></pre>
</div>
</div>
<div class="paragraph">
<p>This has unpredictable effects in the environment.
In this case the programmer did not follow the correct protocol for usage of the SPI interface.</p>
</div>
<div class="paragraph">
<p>If we follow the protocol, activity <code>SPI_txRxBytes</code> can be called inside a transaction that submits a command to an RF hardware using SPI.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="blech">activity RF_sendCmdWord (cmd: uint8, dataTx: [SPI_TX_BUF]uint8, len: uint8)
                        (dataRx: [SPI_TX_BUF]uint8)
                        returns int8
    SPI_beginTransfer()

    var res: int8

    // Send command.
    var tmp: [SPI_TX_BUF]uint8 = {cmd} // we have to allocate a big buffer for ONE byte!
    res = run SPI_txRxBytes(tmp, 1)(dataRx)

    if res == 0 then
        // Send data.
        res = run SPI_txRxBytes(dataTx, len)(dataRx)
    end

    SPI_endTransfer()

    return res
end</code></pre>
</div>
</div>
<div class="paragraph">
<p>Again <code>RF_sendCmdWord</code> is a singleton.</p>
</div>
<div class="paragraph">
<p>Now, this activity cannot be called concurrently to one of the SPI interface functions.
The compiler would reject the following code</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="blech">    cobegin
        _ = run RF_sendCmd(RF_CMD_NOP, dataTx, 0)(dataRx)
    with
        SPI_endTransfer()
        await true
    end</code></pre>
</div>
</div>
<div class="paragraph">
<p>This code is completely stupid according to the SPI protocol but is prevented from occuring in a Blech program.</p>
</div>
<div class="paragraph">
<p>The deduced signature for those subprograms looks as follows.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="blech">singleton function SPI_XferBytes (txBuf: [SPI_TX_BUF]uint8, len: uint16)
                                 (rxBuf: [SPI_TX_BUF]uint8)
                                 returns int8

singleton function SPI_isReady () returns bool

singleton function SPI_beginTransfer ()

singleton function SPI_endTransfer ()

singleton SPI_XferBytes
activity SPI_txRxBytes (bufTx: [SPI_TX_BUF]uint8, len: uint16)
                       (bufRx: [SPI_TX_BUF]uint8)
                       returns int8

singleton SPI_beginTransfer, SPI_XferBytes, SPI_endTransfer
activity RF_sendCmdWord (cmd: uint8, dataTx: [SPI_TX_BUF]uint8, len: uint8)
                        (dataRx: [SPI_TX_BUF]uint8)
                        returns int8</code></pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Calls to singletons cause sourrounding code to be singleton too.
This works up to the <code>@[EntryPoint]</code> activity, which naturally is a singleton.
This is not a bug in Blech but a consequence of the use of global variables.
Restricting the use of global variables to the environment enables the programmer to keep the pure application code free from singletons, which is much better than todays practice to use global variables everywhere.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_bits_and_bytes"><a class="anchor" href="#_bits_and_bytes"></a>3. Bits and Bytes</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Some notes on <a href="https://blog.feabhas.com/2014/10/vulnerabilities-in-c-when-integers-go-bad/">C&#8217;s integers</a></p>
</div>
<div class="sect2">
<h3 id="_rename_the_exponentiation_operator"><a class="anchor" href="#_rename_the_exponentiation_operator"></a>Rename the exponentiation operator <code>^</code></h3>
<div class="paragraph">
<p>The exponention operator <code>^</code> should be renamed to <code>**</code> - maybe right associative.</p>
</div>
<div class="paragraph">
<p>Maybe it would be better to deprecate the exponentiation operator completely.
A good argument for this change is given by the <a href="https://devblogs.microsoft.com/csharpfaq/why-doesnt-c-have-a-power-operator/">C# FAQ</a></p>
</div>
<div class="paragraph">
<p>With this change <code>^</code> becomes available for the standard bitwise XOR (exclusive or) operation.</p>
</div>
</div>
<div class="sect2">
<h3 id="_rename_uint_to_nat"><a class="anchor" href="#_rename_uint_to_nat"></a>Rename <code>uint</code> to <code>nat</code></h3>
<div class="paragraph">
<p>Inspiration <a href="https://sdk.dfinity.org/language-guide/index.html">Motoko</a></p>
</div>
<div class="paragraph">
<p>Reason: <code>uint</code> is not allowed to overflow and saturates in release code or panics in debug code.
The name <code>uint</code> addresses the wrong association.
Therefore we should rename <code>uint</code> to <code>nat</code></p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Maybe we should rename <code>bitsN</code> to <code>wordN</code>.
Those types occur only in 4 different sizes.
The name <code>bits</code> might be associated with an arbitrary number.
Additional inspiration, a <a href="https://whatis.techtarget.com/definition/word">word</a> is a unit of data of a defined bit length.
Therefore we should rename <code>bits</code> to <code>word</code>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_allow_a_type_annotation_for_expressions"><a class="anchor" href="#_allow_a_type_annotation_for_expressions"></a>Allow a type annotation <code>:</code> for expressions</h3>
<div class="paragraph">
<p>It is mainly needed for literals.
It is consistent with type annotation in declarations.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
This is not a cast or a conversion, but only a type annotation, to give literals different meanings.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_eliminate_floatliteral32"><a class="anchor" href="#_eliminate_floatliteral32"></a>Eliminate <code>floatLiteral32</code></h3>
<div class="paragraph">
<p>Instead of using the specific <code>floatLiteral32</code> we should use a type annotation.
With a type annotation any number literal can be used as a checked float literal.
This especially simplifies generic code.
Type annotation are anyway needed for binary, octal and hexadecimal literals.</p>
</div>
<div class="paragraph">
<p>By default a floatLiteral and hexFloatLiteral are of type <code>float64</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Check that hexfloat literals are precise representations for their type.
NOTE: Maybe the default should be <code>float32</code> for embedded systems?
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Any <code>natLiteral</code> can be annotated with a float type.
The range is checked, to get a precise float representation.</p>
</div>
<div class="paragraph">
<p>The following are all valid float literals.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="blech">(42: float64)
(42: float32)

(-17: float32)
(-1.2: float32)

42.0 // has type float64
(42.0: float32)</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_bit_types"><a class="anchor" href="#_bit_types"></a>Bit types</h3>
<div class="paragraph">
<p>Bit types allow bitwise, relational, and arithmetic operators.
Arithmetic operators wrap-around.</p>
</div>
<div class="paragraph">
<p>Different to <code>nat</code> types which must not over- or underflow.</p>
</div>
</div>
<div class="sect2">
<h3 id="_bitwise_operators"><a class="anchor" href="#_bitwise_operators"></a>Bitwise operators</h3>
<div class="paragraph">
<p>Blech provides the standard set of <a href="https://en.wikipedia.org/wiki/Bitwise_operations_in_C">bitwise operators known from C</a>.
Different to C these operators work on <code>bitsN</code> types instead of unsigned <code>uintN</code> or signed <code>intN</code> types.</p>
</div>
<div class="sect3">
<h4 id="_unary_bitwise_operator"><a class="anchor" href="#_unary_bitwise_operator"></a>Unary bitwise operator</h4>
<div class="paragraph">
<p>For N = 8, 16, 32, 64</p>
</div>
<div class="paragraph">
<p>Bitwise negation: <code>~</code>
Type: <code>function (bitsN) returns bitsN</code></p>
</div>
</div>
<div class="sect3">
<h4 id="_binary_bitwise_operators"><a class="anchor" href="#_binary_bitwise_operators"></a>Binary bitwise operators</h4>
<div class="paragraph">
<p>More info on [bitwise operations](<a href="https://en.wikipedia.org/wiki/Bitwise_operation" class="bare">https://en.wikipedia.org/wiki/Bitwise_operation</a>).</p>
</div>
<div class="paragraph">
<p>For N = 8, 16, 32, 64</p>
</div>
<div class="paragraph">
<p>Bitwise and: <code>&amp;</code>
Bitwise or: <code>|</code>
Bitwise xor: <code>^</code></p>
</div>
<div class="paragraph">
<p>Type: <code>function (bitsN , bitsN) returns bitsN</code></p>
</div>
</div>
<div class="sect3">
<h4 id="_shift_and_rotate_operators"><a class="anchor" href="#_shift_and_rotate_operators"></a>Shift and rotate operators</h4>
<div class="paragraph">
<p>Standard shift operators</p>
</div>
<div class="paragraph">
<p>shift left: <code>&lt;&lt;</code>
shift right: <code>&gt;&gt;</code></p>
</div>
<div class="paragraph">
<p>Type: <code>function (bitsN, AnyNat) returns bitsN</code></p>
</div>
<div class="paragraph">
<p>Additionally Blech should provide advanced shift operators</p>
</div>
<div class="paragraph">
<p>Arithmetic shift right: <code>+&gt;&gt;</code>
left rotate: <code>&lt;&lt;&gt;</code>
right rotate: <code>&lt;&gt;&gt;</code></p>
</div>
<div class="paragraph">
<p>Type: <code>function (bitsN, AnyNat) returns bitsN</code></p>
</div>
<div class="paragraph">
<p>These operators can be defined as Macros.
If the macro has a suitable form, C compilers can translate circular shifts into one machine instruction.
C compilers recognize the <a href="https://en.wikipedia.org/wiki/Circular_shift#Implementing_circular_shifts">circular shift idiom</a>.</p>
</div>
<div class="paragraph">
<p>The shift and rotate amount is a general unsigned integer type.
It is considered modulo the <code>bitsN</code> width <code>N</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_arithmetic_operators"><a class="anchor" href="#_arithmetic_operators"></a>Arithmetic operators</h4>
<div class="paragraph">
<p>As arithmetic types, <code>bitsN</code> types implement numeric wrap-around (modulo <code>2**N</code>).</p>
</div>
</div>
<div class="sect3">
<h4 id="_implicit_conversion"><a class="anchor" href="#_implicit_conversion"></a>Implicit conversion</h4>
<div class="paragraph">
<p><a href="https://www.guru99.com/c-type-casting.html">Implicit conversion in C</a> is complicated.</p>
</div>
<div class="paragraph">
<p>Implicit conversion is only allowed if no representation change is necessary.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>int8</code> &#8594; <code>int16</code> &#8594; <code>int32</code> &#8594; <code>int64</code></p>
</li>
<li>
<p><code>float32</code> &#8594; <code>float64</code></p>
</li>
<li>
<p><code>nat8</code> &#8594; <code>nat16</code> &#8594; <code>nat32</code> &#8594; <code>nat64</code></p>
</li>
<li>
<p><code>bits8</code> &#8594; <code>bits16</code> &#8594; <code>bits32</code> &#8594; <code>bits64</code></p>
</li>
</ul>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
The representation of <code>char</code> is still not decided
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_safe_conversion_using_as"><a class="anchor" href="#_safe_conversion_using_as"></a>Safe conversion using <code>as</code></h4>
<div class="paragraph">
<p>Conversion using the operator <code>as</code> can be used for values.
That means:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>for right-hand side values</p>
</li>
<li>
<p>for function input parameters</p>
</li>
<li>
<p>for activity input parameters of simple type: <code>intN</code>, <code>natN</code>, <code>bitsN</code>, <code>floatN</code>, <code>char</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Conversion with representation change is only allowed if no information is lost (has the same bit-size).</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_no_subtyping_for_bitsn_types"><a class="anchor" href="#_no_subtyping_for_bitsn_types"></a>No subtyping for <code>bitsN</code> types</h3>
<div class="paragraph">
<p>Whenever &lt;exp&gt; has type T and T &lt;: U (T subtypes U) then by virture of implicit subsumption, &lt;exp&gt; also has type U (without extra syntax).</p>
</div>
<div class="paragraph">
<p>In general, this means that an expression of a more specific type may appear wherever an expression of a more general type is expected, provided the specific and general types are related by subtyping.</p>
</div>
<div class="paragraph">
<p><code>bitsN</code> types are in no subtype relation with each other.</p>
</div>
<div class="paragraph">
<p><code>bitsN</code> types are in no subtype relation with other arithmetic types.</p>
</div>
</div>
<div class="sect2">
<h3 id="_literals"><a class="anchor" href="#_literals"></a>Literals</h3>
<div class="paragraph">
<p>Binary, octal and hexadecimal literals have type <code>AnyBits</code>.
Decimal literals have type <code>AnyInteger</code>.</p>
</div>
<div class="paragraph">
<p>All literals of type <code>AnyBits</code> need a type annotation in order to become an appropriate <code>bitsN</code> type.</p>
</div>
<div class="paragraph">
<p>A type annotation can be ommited if an assignment determines the type.</p>
</div>
<div class="paragraph">
<p>For negative values of type <code>AnyInteger</code> the two&#8217;s-complement representation is used to create the bits.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
The two&#8217;s-complement representation for <code>intN</code> is not mandatory in C.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="blech">let b1: bits8 = 0x1
let b2 = 0x1 : bits8
let b3 = (0x1 : bits8) &lt;&lt; 2  // 0x4 as bits8
let b32 = 0x1A4: bits8   // type error not representable in bits8
let b4: bits8 = 255
let b5 = 255 : bits8
let b6: bits8 = -129   // type error, no representable as 2-complement in bits8
let b7 = -128: bits8   // ok
let b8 = (-50 - 150): bits8 // compile time error, not representable as 2-complement in bits8</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_use_of_operations"><a class="anchor" href="#_use_of_operations"></a>Use of operations</h3>
<div class="paragraph">
<p>Bitwise operatorions and arithmetic operations cannot be applied to values of type <code>AnyBits</code>.
Bitwise and arithmetic operations can only be applied to values of type <code>bitsN</code>, that means the size has to be fixed before any operation.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="blech">let x: bits8 = -0x1 // type error size of `0x1` not known, for a suitable unary minus.
let x = -(0x1: bits8) // ok, is (0xFF: bits8), by wrap around.</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_hackers_delight_translated_to_blech"><a class="anchor" href="#_hackers_delight_translated_to_blech"></a>Hacker&#8217;s Delight translated to Blech</h3>
<div class="paragraph">
<p><a href="https://en.wikipedia.org/wiki/Hacker%27s_Delight">Hacker&#8217;s Delight</a> is the definitive source of bitwise programming algorithms.
It should be possible to use these hacks in Blech.</p>
</div>
<div class="paragraph">
<p>Turn off the rightmost 1-bit in a byte, producing 0 if none (e.g. 0b_0101_1000 &#8658; 0b_0101_0000, 0x_00 &#8658; 0x_00).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="blech">var x: bits8
x = x &amp; (x - (1: bits8))
// or
x = x &amp; (x - 0x_01)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Turn on the rightmost 0-bit in a word, producing all 1&#8217;s if none (e.g. 0x7AF3 &#8658; 0x7AF4, 0xFFFF &#8658; 0xFFFF).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="blech">var x: bits32
x = x | (x + (1: bits32))
// or
x = x | (x + 0b_1)</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2020-01-22 22:29:07 +0100
</div>
</div>
<style>
pre.rouge table td { padding: 5px; }
pre.rouge table pre { margin: 0; }
pre.rouge .cm {
  color: #999988;
  font-style: italic;
}
pre.rouge .cp {
  color: #999999;
  font-weight: bold;
}
pre.rouge .c1 {
  color: #999988;
  font-style: italic;
}
pre.rouge .cs {
  color: #999999;
  font-weight: bold;
  font-style: italic;
}
pre.rouge .c, pre.rouge .ch, pre.rouge .cd, pre.rouge .cpf {
  color: #999988;
  font-style: italic;
}
pre.rouge .err {
  color: #a61717;
  background-color: #e3d2d2;
}
pre.rouge .gd {
  color: #000000;
  background-color: #ffdddd;
}
pre.rouge .ge {
  color: #000000;
  font-style: italic;
}
pre.rouge .gr {
  color: #aa0000;
}
pre.rouge .gh {
  color: #999999;
}
pre.rouge .gi {
  color: #000000;
  background-color: #ddffdd;
}
pre.rouge .go {
  color: #888888;
}
pre.rouge .gp {
  color: #555555;
}
pre.rouge .gs {
  font-weight: bold;
}
pre.rouge .gu {
  color: #aaaaaa;
}
pre.rouge .gt {
  color: #aa0000;
}
pre.rouge .kc {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kd {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kn {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kp {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kr {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kt {
  color: #445588;
  font-weight: bold;
}
pre.rouge .k, pre.rouge .kv {
  color: #000000;
  font-weight: bold;
}
pre.rouge .mf {
  color: #009999;
}
pre.rouge .mh {
  color: #009999;
}
pre.rouge .il {
  color: #009999;
}
pre.rouge .mi {
  color: #009999;
}
pre.rouge .mo {
  color: #009999;
}
pre.rouge .m, pre.rouge .mb, pre.rouge .mx {
  color: #009999;
}
pre.rouge .sb {
  color: #d14;
}
pre.rouge .sc {
  color: #d14;
}
pre.rouge .sd {
  color: #d14;
}
pre.rouge .s2 {
  color: #d14;
}
pre.rouge .se {
  color: #d14;
}
pre.rouge .sh {
  color: #d14;
}
pre.rouge .si {
  color: #d14;
}
pre.rouge .sx {
  color: #d14;
}
pre.rouge .sr {
  color: #009926;
}
pre.rouge .s1 {
  color: #d14;
}
pre.rouge .ss {
  color: #990073;
}
pre.rouge .s, pre.rouge .sa, pre.rouge .dl {
  color: #d14;
}
pre.rouge .na {
  color: #008080;
}
pre.rouge .bp {
  color: #999999;
}
pre.rouge .nb {
  color: #0086B3;
}
pre.rouge .nc {
  color: #445588;
  font-weight: bold;
}
pre.rouge .no {
  color: #008080;
}
pre.rouge .nd {
  color: #3c5d5d;
  font-weight: bold;
}
pre.rouge .ni {
  color: #800080;
}
pre.rouge .ne {
  color: #990000;
  font-weight: bold;
}
pre.rouge .nf, pre.rouge .fm {
  color: #990000;
  font-weight: bold;
}
pre.rouge .nl {
  color: #990000;
  font-weight: bold;
}
pre.rouge .nn {
  color: #555555;
}
pre.rouge .nt {
  color: #000080;
}
pre.rouge .vc {
  color: #008080;
}
pre.rouge .vg {
  color: #008080;
}
pre.rouge .vi {
  color: #008080;
}
pre.rouge .nv, pre.rouge .vm {
  color: #008080;
}
pre.rouge .ow {
  color: #000000;
  font-weight: bold;
}
pre.rouge .o {
  color: #000000;
  font-weight: bold;
}
pre.rouge .w {
  color: #bbbbbb;
}
pre.rouge {
  background-color: #f8f8f8;
}
</style>
</body>
</html>